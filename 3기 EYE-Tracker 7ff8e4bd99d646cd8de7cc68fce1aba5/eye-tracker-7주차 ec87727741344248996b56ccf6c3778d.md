# eye-tracker-7주차

![eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled.png](eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled.png)

tobii 공식홈페이지 sync에 관현 설명 ([https://connect.tobiipro.com/s/article/How-can-I-synchronize-the-video-and-the-gaze-data-from-Tobii-Pro-Glasses-2?language=ko](https://connect.tobiipro.com/s/article/How-can-I-synchronize-the-video-and-the-gaze-data-from-Tobii-Pro-Glasses-2?language=ko))

우리는 이미 vts pkg는 livedata파일에 가지고 있기 때문에 pts를 얻어야 한다. 

[https://ffmpeg.zeranoe.com/builds/](https://ffmpeg.zeranoe.com/builds/) ( ffmpeg 다운로드 링크)(디코더)

해당 링크에서 파일을 다운받은뒤 exe파일이 있는 디렉토리로 decoding할 영상을 옮기고 빈공간에 shift+오른쪽클릭 을 하면 해당 디렉토리 위치에서 명령창을 열수 있다. 

 

명령창에 ffprobe -i fullstream.mp4 -show_frames -print_format flat 입력 

 

![eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled%201.png](eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled%201.png)

명령창에 frame당 정보들이 출력되는것을 확인 

 

하지만

![eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled%202.png](eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled%202.png)

![eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled%203.png](eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/Untitled%203.png)

둘(vts,pts)를 비교했을 때 일치하는 수를 찾을 수 없었음 

## 명령어창 레지스터 추가하기

- 아래 그림과 같이 윈도우10의 **오른쪽 클릭**과 **Shift + 오른쪽 클릭** 메뉴에 “여기서 명령창 열기”가 존재하지 않습니다.
    
    ![https://luvery93.github.io/img/2018-10-22-windows10-open-a-command-prompt-in-any-folder-from-the-right-click-context-menu/1.png](https://luvery93.github.io/img/2018-10-22-windows10-open-a-command-prompt-in-any-folder-from-the-right-click-context-menu/1.png)
    
    ![https://luvery93.github.io/img/2018-10-22-windows10-open-a-command-prompt-in-any-folder-from-the-right-click-context-menu/2.png](https://luvery93.github.io/img/2018-10-22-windows10-open-a-command-prompt-in-any-folder-from-the-right-click-context-menu/2.png)
    
- 이 때 오른쪽 클릭 메뉴에 관련된 레지스트리를 수정하면 **Shift + 오른쪽 클릭** 메뉴에 “**여기서 명령창 열기**“를 추가할 수 있습니다.

[add_open_cmd_here_for_windows10 (1).reg](eye-tracker-7%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%20ec87727741344248996b56ccf6c3778d/add_open_cmd_here_for_windows10_(1).reg)

## ffmpeg를 사용하여 pts 데이터를 얻기 위해 먼저 mpeg를 visual studio로 빌드 하겠습니다

### A. 첫번째 방법(실패)

필요한 재료

1. 비주얼 스튜디오

2. MSYS2

툴체인 관리 툴, 대략 리눅스, 유닉스 환경의 개발 소스를 윈도에서 빌드 하기 위한 툴

[https://www.msys2.org/](https://www.msys2.org/)

3. YASM

어셈블러.

[http://yasm.tortall.net/](http://yasm.tortall.net/)

4. ffmpeg

소스를 다운로드

[http://ffmpeg.org/download.html](http://ffmpeg.org/download.html)

1. MSYS2 설치 및 실행설치할 때 위치는 C:\workspace\windows\msys로 한다.설치 후 자동 실행되나 이후에는 msys2_shell.cmd 파일을 클릭하면 msys2 쉘이 실행된다.

![http://postfiles14.naver.net/MjAxNzA0MDVfMTAy/MDAxNDkxMzMwMDg2NDM2.zbeyFrXzq8g1CUxKkX3liNxYNVpUzoBxIfLcMmgA_eMg.2lsBeKG8tNO9t47RpKqs_CNZL-pOFF17n5hUj5qRYIYg.PNG.mapiz/capture-20170405-032058.png?type=w580](http://postfiles14.naver.net/MjAxNzA0MDVfMTAy/MDAxNDkxMzMwMDg2NDM2.zbeyFrXzq8g1CUxKkX3liNxYNVpUzoBxIfLcMmgA_eMg.2lsBeKG8tNO9t47RpKqs_CNZL-pOFF17n5hUj5qRYIYg.PNG.mapiz/capture-20170405-032058.png?type=w580)

MSYS2 쉘에서$pacman -S make gcc diffutils$pacman -S pkg-config입력하여 필요한 패키지 설치 **(이후 확인하니 pkg-config 없으면 문제가 됨)**

2. 기본 링커 이름 변경

C:\workspace\windows\msys\usr\bin\link.exe를 MSVC 의 링커와 충돌 생기지 않도록 link_original.exe 등으로 이름 변경.

3. 위에서 다운로드한 yasm32/64.exe 를 C:\workspace\windows 폴더로 이동해서 yasm.exe로 이름 변경

4. 비주얼 스튜디오 코드쉘 (Developer Command Prompt for VS2015) 실행하고

![http://postfiles6.naver.net/MjAxNzA0MDVfMTEg/MDAxNDkxMzMxMzA5ODk5.cWhOuSm_8lnYGpnvpjiQ_xNhIVXICdobASOCZCCiss4g.-VzRjQslnxxtGn1yvWB1SDVT_EAQ0_eL45lFs2lSyY8g.JPEG.mapiz/cats.jpg?type=w580](http://postfiles6.naver.net/MjAxNzA0MDVfMTEg/MDAxNDkxMzMxMzA5ODk5.cWhOuSm_8lnYGpnvpjiQ_xNhIVXICdobASOCZCCiss4g.-VzRjQslnxxtGn1yvWB1SDVT_EAQ0_eL45lFs2lSyY8g.JPEG.mapiz/cats.jpg?type=w580)

C:\workspace\windows\msys\msys2_shell.cmd -msys -use-full-path입력 

( = 비주얼 스튜디오 빌드 환경에서 msys2 쉘을 오픈한다. )

MSYS2 쉘이 열리면

$ which cl

$ which link를 입력해서 비주얼 스튜디오의 컴파일러,링크가 연동 되었는지 확인함.

혹시 안되어 있으면 no cl ...이라고 나오며 시스템 환경 변수의 PATH에 MSVC cl.exe 및 link.exe 가 있는 폴더를 추가해준다.

.5. 위에서 다운로드한 ffmpeg 소스를 C:\workspace\windows\msys\home아래에 복사 후 MSYS2 쉘에서 ffmpeg 소스 폴더로 들어감 시작 시 home/[user] 폴더에서 시작하므로

 $cd .., $cd ffmpeg... 입력드디어 ./configure make 하면 종료static library 가 필요했으므로$./configure --toolchain=msvc --arch=x86 --enable-yasm --enable-asm --enable-**static** --disable-**shared**스위치로 입력하면 실패한다.